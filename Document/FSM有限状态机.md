# 有限状态机四大因素
- 现态：当前状态
- 条件：可以接受的条件
- 动作：接受的条件-对应执行的动作
> 例如 接受按键A ->播放行走的动画 ， 按键B->播放攻击的动画
- 次态：在动作播放完毕之后需要切入的状态 

# 需要考虑的因素
## 1. 谁来控制状态A->跳入状态B，也就是所谓的条件有谁判断。
> 1. 技能控制：每一个技能携带一个跳转的状态，可以直接进入尝试跳入状态，或者强行进入状态。
> 2. 输入控制：在点击，键盘输入的时候，通过映射，获取到应该转换道德状态，尝试进行状态跳转
> 3. 为什么不是状态机控制状态转换：会形成如下操作
>> 将点击W键发送给状态机，状态机遍历当前左右的状态，检测每一个状态是否只接受W键，输入，正确则进入这个状态。这还只是一个简单的输入，没有涉及到更复杂的操作。

## 2. 是否需要引入中间件状态管理器，用来控制同时应对对个不一样目标的状态变化。
> A物体维护的状态列表和B物体维护的状态列表不相同。

## 3. 条件是否可以脱离出来，形成单独的文件。方便用来进行可视化编程？
## 4. 状态是否支持强行跳转，
> 例如： A状态原本不支持跳转到B状态，但是现在因为一些原因需要强行跳转到B状态。<br>
> 实例：对象A在执行攻击的中途，被打击眩晕。需要进入眩晕状态
## 5. 多状态如何实现?
> **例如:玩家在眩晕状态的时候，又被击飞。如何来标识眩晕和击飞状态?**

> 实现方法1：运行状态返回到上一个状态，继续进行上一个未完成的状态。

## 6. 状态使用静态类，还是普通类
采用静态类的好处：因为每一个状态机需要挂载给每一个对象，此时如果使用静态类可以有效的减少new方法所产生的内存消耗。

采用普通类的好处：可以在某一个具体的状态里面记录独有的参数，例如可以在状态开始的时候给持续时间赋值，在update的时候减少，到0的时候跳转到下一个状态中去。


# 实现
## 状态部分
- 状态存留时间：自动跳转到下一状态
- 状态不需要存留时间：无外部触发，永远维持当前状态
> 可以将状态的自动跳转状态指向自己，形成循环。
- 状态等级：当当前状态动作正在执行的时候，允许直接跳向高等级状态，不允许直接跳向低等级和同等级状态。
## 状态类
和每一个状态绑定，当进入这个状态之后，会进行自己的逻辑操作，然后转换到另一个状态。

**OnTryEnter**:进入状态之前判断，有一些状态有单独的判断逻辑是否可以进入。

**OnEnter**:进入状态的初始化

**OnUpdate**:进入状态的每一帧调用

**OnExit**:退出当前状态调用

## 条件
- 两个互斥状态无法直接跳转，
> 设立root。根据root向上查询所有的互斥状态。然后在判断当前状态和目标状态之间是否是互斥的。
> 互斥状态可以做成单项通道，A 可以跳转 B ， B 不可以跳转 A

